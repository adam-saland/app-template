!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Microphone=e():t.Microphone=e()}(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.exports=function(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}},function(t,e,n){"use strict";n.r(e);var o=n(0),r=n.n(o),i=n(1),s=n.n(i);function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.addHeader,o=void 0===n||n,r=e.streaming,i=void 0!==r&&r,s=e.sampleRate,a=void 0===s?16e3:s,c=e.mono,l=void 0===c||c,f=new DataView(new ArrayBuffer((o?44:0)+2*t.length));return o&&(u(f,0,"RIFF"),f.setUint32(4,i?4294967295:32+2*t.length,!0),u(f,8,"WAVE"),u(f,12,"fmt "),f.setUint32(16,16,!0),f.setUint16(20,1,!0),f.setUint16(22,l?1:2,!0),f.setUint32(24,a,!0),f.setUint32(28,a*(l?2:4),!0),f.setUint16(32,l?2:4,!0),f.setUint16(34,16,!0),u(f,36,"data"),f.setUint32(40,i?4294967295:2*t.length,!0)),function(t,e,n){n.forEach((function(n,o){var r=Math.max(-1,Math.min(1,n));t.setInt16(e+2*o,r<0?32768*r:32767*r,!0)}))}(f,o?44:0,t),new Blob([f],{type:"audio/wav"})}function u(t,e,n){n.split("").forEach((function(n,o){t.setUint8(e+o,n.charCodeAt(0))}))}n.d(e,"flatten",(function(){return f})),n.d(e,"interleave",(function(){return h})),n.d(e,"downsample",(function(){return d}));var c=[6253e-7,-9991e-7,-.0016085,4661e-7,.0033264,.0017113,-.0047963,-.0066555,.0033279,.0135469,.0043632,-.0185222,-.0201074,.0147855,.0424725,.0070493,-.0664233,-.0653794,.0849329,.3036509,.4084668,.3036509,.0849329,-.0653794,-.0664233,.0070493,.0424725,.0147855,-.0201074,-.0185222,.0043632,.0135469,.0033279,-.0066555,-.0047963,.0017113,.0033264,4661e-7,-.0016085,-9991e-7,6253e-7],l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.bufferSize,i=void 0===o?4096:o,s=n.exportSampleRate,a=void 0===s?16e3:s,u=n.mono,c=void 0===u||u,l=n.streaming,f=void 0===l||l,h=n.audioContext,d=void 0===h?window.AudioContext||window.webkitAudioContext:h;r()(this,t),this.stream=e,this.bufferSize=i,this.exportSampleRate=a,this.mono=c,this.streaming=f;try{this.context=new d({sampleRate:a}),this.source=this.context.createMediaStreamSource(this.stream)}catch(t){this.context=new d,this.source=this.context.createMediaStreamSource(this.stream)}this.downsample=this.context.sampleRate>this.exportSampleRate}return s()(t,[{key:"start",value:function(){var t=this,e=this.mono?1:2;return this.node=this.context.createScriptProcessor(this.bufferSize,e,e),this.source.connect(this.node),this.node.connect(this.context.destination),this.node.onaudioprocess=function(e){t.c0Bufs.push(e.inputBuffer.getChannelData(0).slice()),t.mono||t.c1Bufs.push(e.inputBuffer.getChannelData(1).slice())},this.c0Bufs=[],this.c1Bufs=[],this.exportedHeader=!1,this}},{key:"stop",value:function(){return this.node.onaudioprocess=null,this.node.disconnect(),this.node=null,this}},{key:"export",value:function(){if(0===this.c0Bufs.length)return new Blob([],{type:"audio/wav"});var t,e,n=f(this.c0Bufs),o=f(this.c1Bufs);if(this.mono)if(this.downsample){var r=d(n,this.context.sampleRate,this.exportSampleRate);t=r.rate,e=r.samples}else t=this.context.sampleRate,e=n;else if(this.downsample){var i=d(f(this.c0Bufs),this.context.sampleRate,this.exportSampleRate),s=d(f(this.c1Bufs),this.context.sampleRate,this.exportSampleRate);t=i.rate,e=h(i.samples,s.samples)}else t=this.context.sampleRate,e=h(n,o);this.downsample?(this.c0Bufs=[n.slice(n.length-c.length)],this.c1Bufs=[o.slice(o.length-c.length)]):(this.c0Bufs=[],this.c1Bufs=[]);var u=a(e,{sampleRate:t,mono:this.mono,streaming:this.streaming,addHeader:!this.streaming||!this.exportedHeader});return this.exportedHeader=!0,u}}]),t}();function f(t){for(var e=new Float32Array(t.reduce((function(t,e){return t+e.length}),0)),n=0,o=0;o<t.length;n+=t[o].length,o++)e.set(t[o],n);return e}function h(t,e){for(var n=new Float32Array(2*t.length),o=0;o<t.length;o++)n[2*o]=t[o],n[2*o+1]=e[o];return n}function d(t,e,n){if(n>e)throw new Error("desired rate must be less than original rate");for(var o=function(t){for(var e=Math.max(0,t.length-c.length+1),n=new Float32Array(e),o=0;o<e;o++)for(var r=0;r<c.length;r++)n[o]+=t[o+r]*c[r];return n}(t),r=Math.floor(e/n),i=new Float32Array(Math.round(o.length/r)),s=0,a=0;s<i.length;s++,a+=r)i[s]=o[a];return{rate:e/r,samples:i}}e.default=l}]).default}));